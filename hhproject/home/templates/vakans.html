{% extends 'base.html' %}
{% load static %}

{% block title %}–í–∞–∫–∞–Ω—Å–∏–∏ - CareerHub{% endblock %}

{% block content %}
<section class="vacancies-section">
    <div class="container">
        <div class="row mb-4">
            <div class="col-12">
                <h1 class="display-5 fw-bold text-center mb-3">–ù–∞–π–¥–∏—Ç–µ —Å–≤–æ—é –∏–¥–µ–∞–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É</h1>
                <div class="search-box">
                    <form method="get" action="{% url 'vakansi_page' %}" id="search-form">
                       <div class="row g-2 align-items-center">
                            <div class="col-md-10">
                                <input type="text" name="search" class="form-control form-control-lg border-0" 
                                    placeholder="–î–æ–ª–∂–Ω–æ—Å—Ç—å, –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –∏–ª–∏ –∫–æ–º–ø–∞–Ω–∏—è" 
                                    value="{{ request.GET.search }}" id="search-input">
                            </div>
                            <div class="col-md-2">
                                <button type="submit" class="btn btn-primary btn-lg w-100" id="search-btn">–ù–∞–π—Ç–∏</button>
                            </div>
                        </div>
                    </form>
                </div>
                
                <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∞ –≥–æ—Ä—è—á–∏—Ö –∫–ª–∞–≤–∏—à -->
                <div class="hotkeys-hint mt-3 text-center">
                    <small class="text-muted">
                        <strong>–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏:</strong> 
                        Alt+F - —Å–±—Ä–æ—Å —Ñ–∏–ª—å—Ç—Ä–æ–≤, Alt+C - –æ—á–∏—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫, Alt+S - —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞, 
                        Alt+H - —Å–ø—Ä–∞–≤–∫–∞, Alt+R - –æ–±–Ω–æ–≤–∏—Ç—å, Alt+L - –ª–∞–π–∫, Alt+A - –æ—Ç–∫–ª–∏–∫
                    </small>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-3">
                <div class="filter-sidebar">
                    <h5 class="mb-3">–§–∏–ª—å—Ç—Ä—ã</h5>
                    
                    <form method="get" action="{% url 'vakansi_page' %}" id="filter-form">
                        {% if request.GET.search %}
                            <input type="hidden" name="search" value="{{ request.GET.search }}">
                        {% endif %}
                        {% if request.GET.sort %}
                            <input type="hidden" name="sort" value="{{ request.GET.sort }}">
                        {% endif %}
                        
                        <div class="mb-4">
                            <h6>–¢–∏–ø –∑–∞–Ω—è—Ç–æ—Å—Ç–∏</h6>
                            {% for condition in work_conditions %}
                            <div class="form-check">
                                <input class="form-check-input employment-filter" type="checkbox" 
                                       name="employment" value="{{ condition.work_conditions_name }}" 
                                       id="emp_{{ forloop.counter }}"
                                       {% if condition.work_conditions_name in selected_employments %}checked{% endif %}>
                                <label class="form-check-label" for="emp_{{ forloop.counter }}">
                                    {{ condition.work_conditions_name }}
                                </label>
                            </div>
                            {% endfor %}
                        </div>

                        <div class="mb-4">
                            <h6>–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã</h6>
                            <div class="form-check">
                                <input class="form-check-input experience-filter" type="checkbox" 
                                       name="experience" value="–ë–µ–∑ –æ–ø—ã—Ç–∞" id="exp_no"
                                       {% if '–ë–µ–∑ –æ–ø—ã—Ç–∞' in selected_experiences %}checked{% endif %}>
                                <label class="form-check-label" for="exp_no">–ë–µ–∑ –æ–ø—ã—Ç–∞</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input experience-filter" type="checkbox" 
                                       name="experience" value="1-3 –≥–æ–¥–∞" id="exp_1-3"
                                       {% if '1-3 –≥–æ–¥–∞' in selected_experiences %}checked{% endif %}>
                                <label class="form-check-label" for="exp_1-3">1-3 –≥–æ–¥–∞</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input experience-filter" type="checkbox" 
                                       name="experience" value="3-6 –ª–µ—Ç" id="exp_3-6"
                                       {% if '3-6 –ª–µ—Ç' in selected_experiences %}checked{% endif %}>
                                <label class="form-check-label" for="exp_3-6">3-6 –ª–µ—Ç</label>
                            </div>
                        </div>

                        <div class="mb-4">
                            <h6>–ó–∞—Ä–ø–ª–∞—Ç–∞, ‚ÇΩ</h6>
                            <div class="row g-2">
                                <div class="col-6">
                                    <input type="number" class="form-control" name="salary_from" 
                                           placeholder="–û—Ç" value="{{ salary_from }}" id="salary-from">
                                </div>
                                <div class="col-6">
                                    <input type="number" class="form-control" name="salary_to" 
                                           placeholder="–î–æ" value="{{ salary_to }}" id="salary-to">
                                </div>
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary w-100 mb-2">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
                        <button type="button" class="btn btn-outline-primary w-100" onclick="resetFilters()">–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
                    </form>
                </div>
            </div>

            <div class="col-lg-9">
                <div class="sorting-options">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <span class="text-muted">–ù–∞–π–¥–µ–Ω–æ –≤–∞–∫–∞–Ω—Å–∏–π: <strong>{{ page_obj.paginator.count }}</strong></span>
                        </div>
                        <div class="col-md-6 text-end">
                            <select class="form-select" id="sort-select" style="width: auto; display: inline-block;">
                                <option value="newest" {% if request.GET.sort == 'newest' or not request.GET.sort %}selected{% endif %}>–°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ</option>
                                <option value="salary_high" {% if request.GET.sort == 'salary_high' %}selected{% endif %}>–ü–æ —É–±—ã–≤–∞–Ω–∏—é –∑–∞—Ä–ø–ª–∞—Ç—ã</option>
                                <option value="salary_low" {% if request.GET.sort == 'salary_low' %}selected{% endif %}>–ü–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –∑–∞—Ä–ø–ª–∞—Ç—ã</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div id="vacanciesList">
                    {% for vacancy in page_obj %}
                    <div class="vacancy-card" data-vacancy-id="{{ vacancy.id }}">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <a href="{% url 'vacancy_detail' vacancy.id %}" class="vacancy-title-link">
                                    <h3 class="vacancy-title">{{ vacancy.position|default:'–ù–µ—Ç –ø–æ–∑–∏—Ü–∏–∏' }}</h3>
                                </a>
                                <p class="company-name mb-2">{{ vacancy.company.name|default:'–ù–µ—Ç –∫–æ–º–ø–∞–Ω–∏–∏' }}</p>
                                
                                <div class="vacancy-meta">
                                    <div class="vacancy-info">
                                        <i class="fas fa-briefcase"></i>
                                        {{ vacancy.work_conditions.work_conditions_name|default:'–ù–µ —É–∫–∞–∑–∞–Ω–æ' }}
                                    </div>
                                    <div class="vacancy-info">
                                        <i class="fas fa-clock"></i>
                                        –ü–æ–ª–Ω—ã–π –¥–µ–Ω—å
                                    </div>
                                    {% if vacancy.work_format == 'remote' %}
                                    <div class="vacancy-remote">
                                        <i class="fas fa-home"></i> –£–¥–∞–ª–µ–Ω–Ω–æ
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <p class="vacancy-description">{{ vacancy.description|truncatewords:25|default:'–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è' }}</p>
                            </div>
                            <div class="col-md-4 text-end">
                                <div class="salary mb-2">{{ vacancy.salary_min|default:0 }} - {{ vacancy.salary_max|default:0 }} ‚ÇΩ</div>
                                
                                <div class="vacancy-stats">
                                    <div class="vacancy-views">
                                        <i class="fas fa-eye"></i> {{ vacancy.views }} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
                                    </div>
                                    <div class="vacancy-date">
                                        <i class="fas fa-calendar"></i> {{ vacancy.created_date|date:"d.m.Y"|default:'–ù–µ—Ç –¥–∞—Ç—ã' }}
                                    </div>
                                </div>
                                
                                <div class="mt-3">
                                    {% if user.is_authenticated and user.user_type == 'applicant' %}
                                        {% if vacancy.has_response %}
                                            <button class="btn btn-success" disabled>–û—Ç–∫–ª–∏–∫ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω</button>
                                        {% else %}
                                            <a href="{% url 'apply_to_vacancy' vacancy.id %}" class="btn btn-primary apply-btn">–û—Ç–∫–ª–∏–∫–Ω—É—Ç—å—Å—è</a>
                                        {% endif %}
                                    {% elif not user.is_authenticated %}
                                        <a href="{% url 'login_user' %}?next={{ request.path }}" class="btn btn-primary">–û—Ç–∫–ª–∏–∫–Ω—É—Ç—å—Å—è</a>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>  
                    {% empty %}
                    <div class="text-center py-5">
                        <h4>üòî –í–∞–∫–∞–Ω—Å–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h4>
                        <p class="text-muted">–ü—Ä–æ–≤–µ—Ä—å —Ñ–∏–ª—å—Ç—Ä—ã</p>
                    </div>
                    {% endfor %}
                </div>

                {% if page_obj.has_other_pages %}
                <nav aria-label="Page navigation" class="mt-4">
                    <ul class="pagination justify-content-center">
                        {% if page_obj.has_previous %}
                        <li class="page-item">
                            <a class="page-link" href="?page={{ page_obj.previous_page_number }}{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}">–ù–∞–∑–∞–¥</a>
                        </li>
                        {% else %}
                        <li class="page-item disabled">
                            <span class="page-link">–ù–∞–∑–∞–¥</span>
                        </li>
                        {% endif %}

                        {% for i in page_obj.paginator.page_range %}
                            {% if page_obj.number == i %}
                            <li class="page-item active">
                                <span class="page-link">{{ i }}</span>
                            </li>
                            {% else %}
                            <li class="page-item">
                                <a class="page-link" href="?page={{ i }}{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}">{{ i }}</a>
                            </li>
                            {% endif %}
                        {% endfor %}

                        {% if page_obj.has_next %}
                        <li class="page-item">
                            <a class="page-link" href="?page={{ page_obj.next_page_number }}{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}">–í–ø–µ—Ä–µ–¥</a>
                        </li>
                        {% else %}
                        <li class="page-item disabled">
                            <span class="page-link">–í–ø–µ—Ä–µ–¥</span>
                        </li>
                        {% endif %}
                    </ul>
                </nav>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<!-- –ö–Ω–æ–ø–∫–∞ –ø–æ–º–æ—â–∏ -->
<div class="hotkeys-help-btn" onclick="showHotkeysHelp()">
    <i class="fas fa-keyboard"></i>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–º–æ—â–∏ -->
<div id="hotkeysModal" class="hotkeys-modal" style="display: none;">
    <div class="hotkeys-modal-content">
        <div class="hotkeys-modal-header">
            <h5>–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ - –í–∞–∫–∞–Ω—Å–∏–∏</h5>
            <button type="button" onclick="hideHotkeysHelp()">√ó</button>
        </div>
        <div class="hotkeys-modal-body">
            <div class="hotkey-item">
                <kbd>Alt</kbd> + <kbd>F</kbd> - –°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã
            </div>
            <div class="hotkey-item">
                <kbd>Alt</kbd> + <kbd>C</kbd> - –û—á–∏—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫
            </div>
            <div class="hotkey-item">
                <kbd>Alt</kbd> + <kbd>S</kbd> - –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É
            </div>
            <div class="hotkey-item">
                <kbd>Alt</kbd> + <kbd>R</kbd> - –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
            </div>
            <div class="hotkey-item">
                <kbd>Alt</kbd> + <kbd>L</kbd> - –õ–∞–π–∫–Ω—É—Ç—å –≤–∞–∫–∞–Ω—Å–∏—é (–ø–µ—Ä–≤—É—é –≤ —Å–ø–∏—Å–∫–µ)
            </div>
            <div class="hotkey-item">
                <kbd>Alt</kbd> + <kbd>A</kbd> - –û—Ç–∫–ª–∏–∫–Ω—É—Ç—å—Å—è –Ω–∞ –≤–∞–∫–∞–Ω—Å–∏—é (–ø–µ—Ä–≤—É—é –≤ —Å–ø–∏—Å–∫–µ)
            </div>
            <div class="hotkey-item">
                <kbd>Enter</kbd> - –í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–∏—Å–∫ (–≤ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞)
            </div>
            <div class="hotkey-item">
                <kbd>Alt</kbd> + <kbd>H</kbd> - –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É
            </div>
        </div>
        <div class="hotkeys-modal-footer">
            <button type="button" class="btn btn-primary" onclick="hideHotkeysHelp()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>
</div>

<script>
// –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
console.log('=== HOTKEYS DEBUG ===');
console.log('Script loaded on vacancies page');

let currentVacancyIndex = 0;

// –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤–∞–∫–∞–Ω—Å–∏–π
document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM loaded, setting up hotkeys...');
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≥–æ—Ä—è—á–∏—Ö –∫–ª–∞–≤–∏—à
    document.addEventListener('keydown', function(e) {
        console.log('Key pressed:', {
            key: e.key,
            code: e.code,
            altKey: e.altKey,
            ctrlKey: e.ctrlKey,
            shiftKey: e.shiftKey,
            target: e.target.tagName,
            targetId: e.target.id
        });

        // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –µ—Å–ª–∏ –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞ (–∫—Ä–æ–º–µ Enter –¥–ª—è –ø–æ–∏—Å–∫–∞)
        if ((e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.tagName === 'SELECT') && e.key !== 'Enter') {
            console.log('Skipping - in input field');
            return;
        }

        // Enter –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ Alt
        if (e.key === 'Enter' && e.target.id === 'search-input') {
            console.log('Enter pressed in search, submitting form');
            e.preventDefault();
            document.getElementById('search-form').submit();
            return;
        }

        // –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å Alt
        if (!e.altKey) {
            console.log('Skipping - Alt key not pressed');
            return;
        }

        console.log('Alt key pressed, processing hotkey:', e.key);
        e.preventDefault();

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ—á–µ—Ç–∞–Ω–∏–π –∫–ª–∞–≤–∏—à —Å Alt
        switch(e.key.toLowerCase()) {
            case 'f': // –°–±—Ä–æ—Å —Ñ–∏–ª—å—Ç—Ä–æ–≤
                console.log('Alt+F - Resetting filters');
                resetFilters();
                break;
                
            case 'c': // –û—á–∏—Å—Ç–∫–∞ –ø–æ–∏—Å–∫–∞
                console.log('Alt+C - Clearing search');
                clearSearch();
                break;
                
            case 's': // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
                console.log('Alt+S - Toggling sort');
                toggleSort();
                break;
                
            case 'r': // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
                console.log('Alt+R - Refreshing page');
                location.reload();
                break;
                
            case 'l': // –õ–∞–π–∫–Ω—É—Ç—å –≤–∞–∫–∞–Ω—Å–∏—é
                console.log('Alt+L - Liking vacancy');
                likeFirstVacancy();
                break;
                
            case 'a': // –û—Ç–∫–ª–∏–∫–Ω—É—Ç—å—Å—è –Ω–∞ –≤–∞–∫–∞–Ω—Å–∏—é
                console.log('Alt+A - Applying to vacancy');
                applyToFirstVacancy();
                break;
                
            case 'h': // –°–ø—Ä–∞–≤–∫–∞
                console.log('Alt+H - Showing help');
                showHotkeysHelp();
                break;
                
            default:
                console.log('Unknown hotkey:', e.key);
        }
    });
});

// –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
const sortSelect = document.getElementById('sort-select');
if (sortSelect) {
    sortSelect.addEventListener('change', function() {
        console.log('Sort changed to:', this.value);
        const urlParams = new URLSearchParams(window.location.search);
        urlParams.set('sort', this.value);
        window.location.href = '?' + urlParams.toString();
    });
}

// –°–±—Ä–æ—Å —Ñ–∏–ª—å—Ç—Ä–æ–≤
function resetFilters() {
    console.log('resetFilters function called');
    const baseUrl = "{% url 'vakansi_page' %}";
    const params = new URLSearchParams();
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –ø–æ–∏—Å–∫ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –µ—Å–ª–∏ –µ—Å—Ç—å
    {% if request.GET.search %}
        params.set('search', '{{ request.GET.search }}');
    {% endif %}
    {% if request.GET.sort %}
        params.set('sort', '{{ request.GET.sort %}');
    {% endif %}
    
    const newUrl = baseUrl + (params.toString() ? '?' + params.toString() : '');
    console.log('Redirecting to:', newUrl);
    window.location.href = newUrl;
}

// –û—á–∏—Å—Ç–∫–∞ –ø–æ–∏—Å–∫–∞
function clearSearch() {
    console.log('clearSearch function called');
    const baseUrl = "{% url 'vakansi_page' %}";
    const params = new URLSearchParams();
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –µ—Å–ª–∏ –µ—Å—Ç—å
    {% if request.GET.sort %}
        params.set('sort', '{{ request.GET.sort %}');
    {% endif %}
    
    const newUrl = baseUrl + (params.toString() ? '?' + params.toString() : '');
    console.log('Redirecting to:', newUrl);
    window.location.href = newUrl;
}

// –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
function toggleSort() {
    console.log('toggleSort function called');
    const currentSort = "{{ request.GET.sort|default:'newest' }}";
    console.log('Current sort:', currentSort);
    
    let newSort;
    switch(currentSort) {
        case 'newest':
            newSort = 'salary_high';
            break;
        case 'salary_high':
            newSort = 'salary_low';
            break;
        case 'salary_low':
            newSort = 'newest';
            break;
        default:
            newSort = 'salary_high';
    }
    
    console.log('New sort:', newSort);
    const urlParams = new URLSearchParams(window.location.search);
    urlParams.set('sort', newSort);
    const newUrl = '?' + urlParams.toString();
    console.log('Redirecting to:', newUrl);
    window.location.href = newUrl;
}

// –õ–∞–π–∫–Ω—É—Ç—å –ø–µ—Ä–≤—É—é –≤–∞–∫–∞–Ω—Å–∏—é
function likeFirstVacancy() {
    const likeBtn = document.querySelector('.like-btn');
    if (likeBtn) {
        console.log('Liking vacancy:', likeBtn.dataset.vacancyId);
        likeBtn.click();
        showNotification('–í–∞–∫–∞–Ω—Å–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ!', 'success');
    } else {
        showNotification('–ù–µ—Ç –≤–∞–∫–∞–Ω—Å–∏–π –¥–ª—è –ª–∞–π–∫–∞', 'warning');
    }
}

// –û—Ç–∫–ª–∏–∫–Ω—É—Ç—å—Å—è –Ω–∞ –ø–µ—Ä–≤—É—é –≤–∞–∫–∞–Ω—Å–∏—é
function applyToFirstVacancy() {
    const applyBtn = document.querySelector('.apply-btn');
    if (applyBtn) {
        console.log('Applying to vacancy via:', applyBtn.href);
        window.location.href = applyBtn.href;
    } else {
        showNotification('–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–∞–∫–∞–Ω—Å–∏–π –¥–ª—è –æ—Ç–∫–ª–∏–∫–∞', 'warning');
    }
}

// –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `alert alert-${type} position-fixed`;
    notification.style.cssText = `
        top: 20px;
        right: 20px;
        z-index: 9999;
        min-width: 300px;
    `;
    notification.innerHTML = `
        ${message}
        <button type="button" class="btn-close" onclick="this.parentElement.remove()"></button>
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        if (notification.parentElement) {
            notification.remove();
        }
    }, 3000);
}

// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
function showHotkeysHelp() {
    console.log('Showing hotkeys help');
    document.getElementById('hotkeysModal').style.display = 'flex';
}

function hideHotkeysHelp() {
    console.log('Hiding hotkeys help');
    document.getElementById('hotkeysModal').style.display = 'none';
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –æ–∫–Ω–∞
document.addEventListener('click', function(e) {
    const modal = document.getElementById('hotkeysModal');
    if (e.target === modal) {
        hideHotkeysHelp();
    }
});

console.log('Hotkeys setup complete');
</script>

<style>
.hotkeys-help-btn {
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 60px;
    height: 60px;
    background: #007bff;
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    cursor: pointer;
    box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
    z-index: 1000;
    border: none;
    transition: all 0.3s ease;
}

.hotkeys-help-btn:hover {
    background: #0056b3;
    transform: scale(1.1);
}

.hotkeys-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 9999;
}

.hotkeys-modal-content {
    background: white;
    border-radius: 8px;
    width: 90%;
    max-width: 500px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
}

.hotkeys-modal-header {
    padding: 15px 20px;
    border-bottom: 1px solid #dee2e6;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.hotkeys-modal-header h5 {
    margin: 0;
}

.hotkeys-modal-header button {
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: #6c757d;
}

.hotkeys-modal-body {
    padding: 20px;
}

.hotkeys-modal-footer {
    padding: 15px 20px;
    border-top: 1px solid #dee2e6;
    text-align: right;
}

.hotkey-item {
    padding: 10px 0;
    border-bottom: 1px solid #eee;
    display: flex;
    align-items: center;
}

.hotkey-item:last-child {
    border-bottom: none;
}

kbd {
    background: #6c757d;
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-family: monospace;
    margin-right: 8px;
    min-width: 40px;
    display: inline-block;
    text-align: center;
    font-size: 14px;
}

.hotkeys-hint {
    background: #f8f9fa;
    padding: 8px;
    border-radius: 6px;
    border: 1px solid #e9ecef;
    margin-bottom: 10px;
}

.like-btn {
    margin-left: 10px;
}
</style>
{% endblock %}